<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link href="../../../library/tabulator-master 2/dist/css/tabulator.css" rel="stylesheet">
    <link href="../../../library/jquery-ui-1.12.1.custom/jquery-ui.min.css" rel="stylesheet">
    <link href="../../../library/bootstrap-4.4.1-dist/css/bootstrap.min.css" rel="stylesheet" >
    <script src="../../../library/jquery-3.4.1.min.js"></script>
    <script src="../../../library/sheetjs-master/dist/xlsx.full.min.js"></script>
    <script src="../../../library/jquery-ui-1.12.1.custom/jquery-ui.min.js"></script>
    <script src="../../../library/tabulator-master 2/dist/js/tabulator.js"></script>
</head>

<body>
    <div id="example-table"></div>
    <script>

        var tableData = makeData();
        makeTable(tableData);

        //custom max min header filter
        var minMaxFilterEditor = function(cell, onRendered, success, cancel, editorParams){

            var end;
            var container = document.createElement("span");
            //create and style inputs
            var start = document.createElement("input");
            start.setAttribute("type", "number");
            start.setAttribute("placeholder", "Min");
            start.setAttribute("min", 0);
            start.setAttribute("max", 100);
            start.style.padding = "4px";
            start.style.width = "50%";
            start.style.boxSizing = "border-box";
            start.value = cell.getValue();
            function buildValues(){
                success({
                    start:start.value,
                    end:end.value,
                });
            }

            function keypress(e){
                if(e.keyCode == 13){
                    buildValues();
                }

                if(e.keyCode == 27){
                    cancel();
                }
            }

            end = start.cloneNode();
            end.setAttribute("placeholder", "Max");

            start.addEventListener("change", buildValues);
            start.addEventListener("blur", buildValues);
            start.addEventListener("keydown", keypress);

            end.addEventListener("change", buildValues);
            end.addEventListener("blur", buildValues);
            end.addEventListener("keydown", keypress);

            container.appendChild(start);
            container.appendChild(end);

            return container;
        }


        //custom max min filter function
        function minMaxFilterFunction(headerValue, rowValue, rowData, filterParams){
            //headerValue - the value of the header filter element
            //rowValue - the value of the column in this row
            //rowData - the data for the row being filtered
            //filterParams - params object passed to the headerFilterFuncParams property

                if(rowValue){
                    if(headerValue.start != ""){
                        if(headerValue.end != ""){
                            return rowValue >= headerValue.start && rowValue <= headerValue.end;
                        }else{
                            return rowValue >= headerValue.start;
                        }
                    }else{
                        if(headerValue.end != ""){
                            return rowValue <= headerValue.end;
                        }
                    }
                }

            return false; //must return a boolean, true if it passes the filter.
        }



        function makeTable(tableData){
            $(function(){
                var table = new Tabulator("#example-table", {
                    data:tableData,           //load row data from array
                    layout:"fitColumns",      //fit columns to width of table
                    responsiveLayout:"hide",  //hide columns that dont fit on the table
                    tooltips:true,            //show tool tips on cells
                    addRowPos:"top",          //when adding a new row, add it to the top of the table
                    history:true,             //allow undo and redo actions on the table
                    pagination:"local",       //paginate the data
                    paginationSize:7,         //allow 7 rows per page of data
                    movableColumns:true,      //allow column order to be changed
                    resizableRows:true,       //allow row order to be changed
                    dataEdited:function(data){
                        registData(data);
                    },
                    columns:[                 //define the table columns
                        {title:"Name", field:"name", editor:"input", headerFilter:"input"},
                        {title:"Driver", field:"car", formatter:"tickCross", editor:true},
                    ],
                });
            });
        }

        function makeData(){
            var tableData = [
                {name:"Oli Bob", car:1},
                {name:"Mary May", car:true},
                {name:"Christine Lobowski", car:true},
                {name:"Brendon Philips", car:true},
                {name:"Margret Marmajuke", car:true},
            ];
            return tableData;
        }

        function registData(data){
            console.log(data);
        }

    </script>
</body>
</html>